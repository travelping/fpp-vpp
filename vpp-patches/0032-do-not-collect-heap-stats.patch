From e1725e3e631492832a5359165f46c158a3d95a5e Mon Sep 17 00:00:00 2001
From: Vladimir Zhigulin <vladimir.jigulin@travelping.com>
Date: Thu, 7 Dec 2023 14:49:55 +0100
Subject: [PATCH] do not collect heap stats

---
 src/vlib/stats/provider_mem.c | 28 ++++++++++++++--------------
 1 file changed, 14 insertions(+), 14 deletions(-)

diff --git a/src/vlib/stats/provider_mem.c b/src/vlib/stats/provider_mem.c
index f3a3f5d3e..32be5468a 100644
--- a/src/vlib/stats/provider_mem.c
+++ b/src/vlib/stats/provider_mem.c
@@ -25,21 +25,21 @@ enum
 static void
 stat_provider_mem_usage_update_fn (vlib_stats_collector_data_t *d)
 {
-  clib_mem_usage_t usage;
-  clib_mem_heap_t *heap;
-  counter_t **counters = d->entry->data;
-  counter_t *cb;
+  // clib_mem_usage_t usage;
+  // clib_mem_heap_t *heap;
+  // counter_t **counters = d->entry->data;
+  // counter_t *cb;
 
-  heap = vec_elt (memory_heaps_vec, d->private_data);
-  clib_mem_get_heap_usage (heap, &usage);
-  cb = counters[0];
-  cb[STAT_MEM_TOTAL] = usage.bytes_total;
-  cb[STAT_MEM_USED] = usage.bytes_used;
-  cb[STAT_MEM_FREE] = usage.bytes_free;
-  cb[STAT_MEM_USED_MMAP] = usage.bytes_used_mmap;
-  cb[STAT_MEM_TOTAL_ALLOC] = usage.bytes_max;
-  cb[STAT_MEM_FREE_CHUNKS] = usage.bytes_free_reclaimed;
-  cb[STAT_MEM_RELEASABLE] = usage.bytes_overhead;
+  // heap = vec_elt (memory_heaps_vec, d->private_data);
+  // clib_mem_get_heap_usage (heap, &usage);
+  // cb = counters[0];
+  // cb[STAT_MEM_TOTAL] = usage.bytes_total;
+  // cb[STAT_MEM_USED] = usage.bytes_used;
+  // cb[STAT_MEM_FREE] = usage.bytes_free;
+  // cb[STAT_MEM_USED_MMAP] = usage.bytes_used_mmap;
+  // cb[STAT_MEM_TOTAL_ALLOC] = usage.bytes_max;
+  // cb[STAT_MEM_FREE_CHUNKS] = usage.bytes_free_reclaimed;
+  // cb[STAT_MEM_RELEASABLE] = usage.bytes_overhead;
 }
 
 /*
-- 
2.43.0

